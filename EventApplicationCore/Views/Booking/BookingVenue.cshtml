@model EventApplicationCore.Model.BookingVenue
@{
    Layout = "~/Views/Shared/_LayoutNewCustomer.cshtml";
}

<div class="container py-3">
    <div class="row">
        <div class="col-5">
            <form asp-controller="Booking" asp-action="BookingVenue" method="post">
                @Html.AntiForgeryToken()
                <h3><span class="label label-info">Book Venue</span></h3>

                <div class="form-group">
                    <label asp-for="EventTypeID">Event Type</label>
                    <select asp-for="EventTypeID" class="form-control" asp-items="@(new SelectList(string.Empty, "EventID", "EventType"))"></select>
                    <span asp-validation-for="EventTypeID" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="VenueID">Venue Type</label>
                    <select asp-for="VenueID" class="form-control" asp-items="@(new SelectList(string.Empty, "VenueID", "VenueCost"))"></select>
                    <span asp-validation-for="VenueID" class="text-danger"></span>
                </div>

                <div class="form-group">
                    <label asp-for="GuestCount">No .Of Guest</label>
                    <input asp-for="GuestCount" class="form-control" />
                    <span asp-validation-for="GuestCount" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label class="control-label" asp-for="BookingDate">BookingDate</label>
                    <input asp-for="BookingDate" id="BookingDate" type="text" class="form-control" />
                    <span asp-validation-for="BookingDate" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <input type="button" id="btnCheckBooking" class="btn btn-success" onclick="CheckBooking();" value="Check Availability" />
                    <input type="submit" id="btnBookingEvent" class="btn btn-success" onclick="BookingEvent();" value="Book Event" />
                    <a class="btn btn-success" href="/Booking/BookingVenue">Cancel</a>
                </div>
            </form>


        </div>

        <div class="col-7">
            <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                @{
                    var data = (List<EventApplicationCore.Model.Venue>)ViewBag.SliderImages;
                    <ol class="carousel-indicators">
                        @for (int i = 0; i < (data.Count()); i++)
                        {
                            <li data-target="#carouselExampleIndicators" data-slide-to="i"></li>
                        }
                    </ol>

                    <div class="carousel-inner">
                        @for (int i = 0; i < (data.Count()); i++)
                        {
                            <div class="carousel-item">
                                <img class="d-block w-100" src="/@data[i].VenueFilePath" alt="@data[i].VenueName">
                                <div class="carousel-caption d-none d-md-block">
                                    <h5>@data[i].VenueName</h5>
                                </div>
                            </div>
                        }
                    </div>
                }
                <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
        </div>
    </div>
</div>

@*<div class="card card-default"
<div class="card-body p-0">
    <div class="bs-stepper">
        <div class="bs-stepper-header" role="tablist">
            <!-- your steps here -->
            <div class="step" data-target="#event-part">
                <button type="button" class="step-trigger" role="tab" aria-controls="event-part" id="events-part-trigger">
                    <span class="bs-stepper-circle">1</span>
                    <span class="bs-stepper-label">Book Event</span>
                </button>
            </div>
            <div class="line"></div>
            <div class="step" data-target="#equipment-part">
                <button type="button" class="step-trigger" role="tab" aria-controls="equipment-part" id="equipments-part-trigger">
                    <span class="bs-stepper-circle">2</span>
                    <span class="bs-stepper-label">Book Equipment</span>
                </button>
            </div>
            <div class="line"></div>
            <div class="step" data-target="#lightning-part">
                <button type="button" class="step-trigger" role="tab" aria-controls="lightning-part" id="lightnings-part-trigger">
                    <span class="bs-stepper-circle">3</span>
                    <span class="bs-stepper-label">Book Lightnings</span>
                </button>
            </div>
            <div class="line"></div>
            <div class="step" data-target="#food-part">
                <button type="button" class="step-trigger" role="tab" aria-controls="food-part" id="foods-part-trigger">
                    <span class="bs-stepper-circle">4</span>
                    <span class="bs-stepper-label">Book Meal</span>
                </button>
            </div>
            <div class="line"></div>
            <div class="step" data-target="#flower-part">
                <button type="button" class="step-trigger" role="tab" aria-controls="flower-part" id="flowers-part-trigger">
                    <span class="bs-stepper-circle">5</span>
                    <span class="bs-stepper-label">Book Flower</span>
                </button>
            </div>
        </div>
        <div class="bs-stepper-content">
            <!-- your steps content here -->
            <div id="event-part" class="content" role="tabpanel" aria-labelledby="events-part-trigger">
                <div class="row">
                    <div class="col-5">
                        <div class="form-group">
                            <label for="exampleInputEmail1">Email address</label>
                            <input type="email" class="form-control" id="exampleInputEmail1" placeholder="Enter email">
                        </div>
                        <div class="form-group">
                            <label for="exampleInputPassword1">Password</label>
                            <input type="password" class="form-control" id="exampleInputPassword1" placeholder="Password">
                        </div>
                        <form asp-controller="Booking" asp-action="BookingVenue" method="post">
                                @Html.AntiForgeryToken()

                <div class="form-group">
                    <label asp-for="EventTypeID">Event Type</label>
                    <select asp-for="EventTypeID" class="form-control" asp-items="@(new SelectList(string.Empty, "EventID", "EventType"))"></select>
                    <span asp-validation-for="EventTypeID" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="VenueID">Venue Type</label>
                    <select asp-for="VenueID" class="form-control" asp-items="@(new SelectList(string.Empty, "VenueID", "VenueName"))"></select>
                    <span asp-validation-for="VenueID" class="text-danger"></span>
                </div>

                <div class="form-group">
                    <label asp-for="GuestCount">No .Of Guest</label>
                    <input asp-for="GuestCount" class="form-control" />
                    <span asp-validation-for="GuestCount" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label class="control-label" asp-for="BookingDate">BookingDate</label>
                    <input asp-for="BookingDate" id="BookingDate" type="text" class="form-control" />
                    <span asp-validation-for="BookingDate" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <input type="button" id="btnCheckBooking" class="btn btn-success" onclick="CheckBooking();" value="Check Availability" />
                    <input type="submit" id="btnBookingEvent" class="btn btn-success" onclick="BookingEvent();" value="Book Event" />
                    <a class="btn btn-success" href="/Booking/BookingVenue">Cancel</a>
                </div>
            </form>
                        <button class="btn btn-primary" onclick="stepper.next()">Next</button>
                    </div>
                    <div class="col-7">
                        <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                                @{
                                    var data = (List<EventApplicationCore.Model.Venue>)ViewBag.SliderImages;
                        <ol class="carousel-indicators">
                                        @for (int i = 0; i < (data.Count()); i++)
                                        {
                                    <li data-target="#carouselExampleIndicators" data-slide-to="i"></li>
                                        }
                        </ol>

                        <div class="carousel-inner">
                                        @for (int i = 0; i < (data.Count()); i++)
                                        {
                                    <div class="carousel-item">
                                        <img class="d-block w-100" src="/@data[i].VenueFilePath" alt="@data[i].VenueName">
                                        <div class="carousel-caption d-none d-md-block">
                                            <h5>@data[i].VenueName</h5>
                                        </div>
                                    </div>
                                        }
                        </div>
                                }
                <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
                    </div>
                </div>
            </div>
            <div id="equipment-part" class="content" role="tabpanel" aria-labelledby="equipments-part-trigger">
                <div class="form-group">
                    <label for="exampleInputFile">File input</label>
                    <div class="input-group">
                        <div class="custom-file">
                            <input type="file" class="custom-file-input" id="exampleInputFile">
                            <label class="custom-file-label" for="exampleInputFile">Choose file</label>
                        </div>
                        <div class="input-group-append">
                            <span class="input-group-text">Upload</span>
                        </div>
                    </div>
                </div>
                <button class="btn btn-primary" onclick="stepper.previous()">Previous</button>
                <button class="btn btn-primary" onclick="stepper.next()">Next</button>

            </div>
            <div id="lightning-part" class="content" role="tabpanel" aria-labelledby="lightnings-part-trigger">
                <div class="form-group">
                    <label for="exampleInputFile">File input</label>
                    <div class="input-group">
                        <div class="custom-file">
                            <input type="file" class="custom-file-input" id="exampleInputFile">
                            <label class="custom-file-label" for="exampleInputFile">Choose file</label>
                        </div>
                        <div class="input-group-append">
                            <span class="input-group-text">Upload</span>
                        </div>
                    </div>
                </div>
                <button class="btn btn-primary" onclick="stepper.previous()">Previous</button>
                <button class="btn btn-primary" onclick="stepper.next()">Next</button>

            </div>
            <div id="food-part" class="content" role="tabpanel" aria-labelledby="foods-part-trigger">
                <div class="form-group">
                    <label for="exampleInputFile">File input</label>
                    <div class="input-group">
                        <div class="custom-file">
                            <input type="file" class="custom-file-input" id="exampleInputFile">
                            <label class="custom-file-label" for="exampleInputFile">Choose file</label>
                        </div>
                        <div class="input-group-append">
                            <span class="input-group-text">Upload</span>
                        </div>
                    </div>
                </div>
                <button class="btn btn-primary" onclick="stepper.previous()">Previous</button>
                <button class="btn btn-primary" onclick="stepper.next()">Next</button>

            </div>
            <div id="flower-part" class="content" role="tabpanel" aria-labelledby="flowers-part-trigger">
                <div class="form-group">
                    <label for="exampleInputEmail1">Email address</label>
                    <input type="email" class="form-control" id="exampleInputEmail1" placeholder="Enter email">
                </div>
                <div class="form-group">
                    <label for="exampleInputPassword1">Password</label>
                    <input type="password" class="form-control" id="exampleInputPassword1" placeholder="Password">
                </div>
                <button class="btn btn-primary" onclick="stepper.previous()">Previous</button>
                <button type="submit" class="btn btn-primary">Submit</button>
            </div>
        </div>
    </div>
</div> *@


<script type="text/javascript">
$("#carouselExampleIndicators .carousel-inner .carousel-item:first-child").addClass("active");
$(document).ready(function () {
        @if (TempData["BookingMessage"] == null)
        {
            <text>
            $("#btnBookingEvent").hide();
            </text>
        }
        else
        {
            <text>
            $("#btnBookingEvent").hide();
            </text>

        }
        $.getJSON('@Url.Content("~/")' + "api/EventData", function (data) {
            var items = '';
            items += "<option value='" + "" + "'>" + "----Select----" + "</option>";
            $("#EventTypeID").empty();
            $.each(data, function (i, subcategory) {
                items += "<option value='" + subcategory.EventID + "'>" + subcategory.EventType + "</option>";
            });
            $('#EventTypeID').html(items);

            if ('@Model.EventTypeID' != '') {
                $('#EventTypeID').val('@Model.EventTypeID');
            }
        });

    $.getJSON('@Url.Content("~/")' + "api/VenueData", function (data) {
        var items = '';
        items += "<option value='" + "" + "'>" + "----Select----" + "</option>";
        $("#VenueID").empty();
        $.each(data, function (i, subcategory) {
                items += "<option value='" + subcategory.VenueID + "'>" + subcategory.VenueName+"(Rs. "+subcategory.VenueCost +")"+ "</option>";
        });
        $('#VenueID').html(items);

        if ('@Model.VenueID' != '') {
            $('#VenueID').val('@Model.VenueID');
        }
    });

    $("#BookingDate").datepicker
        ({
            dateFormat: "yy-mm-dd",
            changeMonth: true,
            changeYear: true,
            yearRange: "-100:+100",
            minDate: 7,
            onSelect: function (date) {
                var BookingDate = new Date(date);
                var today = new Date();

                if (Date.parse(BookingDate) == Date.parse(today))
                //if (BookingDate == today)
                {
                    $("#BookingDate").val('');
                    alert("Cannot Conduct Event Today itself");
                }
                else {

                }
            }
        });
});

function CheckBooking() {

    if ($('#EventTypeID').val() == '' || $('#EventTypeID').val() == null) {
        alert("Please select Event Type !");
    }
    else if ($('#VenueID').val() == '' || $('#VenueID').val() == null) {
        alert("Please select Venue !");
    }
    else if ($('#GuestCount').val() == '' || $('#GuestCount').val() == null) {
        alert("Please select GuestCount !");
    }
    else if ($('#BookingDate').val() == '' || $('#BookingDate').val() == null) {
        alert("Please select Date of BookingDate !");
    }
    else {

        $.post('@Url.Content("~/")' + "Booking/CheckBooking", {

            EventTypeID: $('#EventTypeID').val(),
            VenueID: $('#VenueID').val(),
            GuestCount: $('#GuestCount').val(),
            BookingDate: $('#BookingDate').val()


        }, function (data) {
            var result = data;


            if (result == "Available") {
                $("#btnCheckBooking").hide();
                $("#btnBookingEvent").show();
                alert("Booking is Available You Can Book your Event !!!");
            }
            else {
                $("#btnCheckBooking").show();
                $("#btnBookingEvent").hide();
                alert("Booking is Not Available on '" + BookingDate.value + "'  Selected Date !!!");
            }
        });
    }
}

// BS-Stepper Init
document.addEventListener('DOMContentLoaded', function () {
    window.stepper = new Stepper(document.querySelector('.bs-stepper'))
})
</script>